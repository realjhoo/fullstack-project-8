extends layout

block content
  //- Show search numbers, and good grammar
  if search === true
    if items > 1
      h1 #{items} Books Found
      a.button(href="/") Home
    else 
      h1 #{items} Book Found
      a.button(href="/") Home
  else
    h1 Books
    a.button(href="/") Home

  a.button(href="/books/new") Create New Book

  //- Search Form
  p
  form(method="post" action="/" )
    input(type="text" name="searchTerm" placeholder="Search...")
    input.searchButton(type="submit" value="Search")

  //- Show the Book List
  table
    thead 
      th Title
      th Author 
      th Genre 
      th Year 
    tbody 
    each book in books
      tr
        //- Pagination Happens Here
        - const itemsPerPage = Math.ceil(items / pages)
        - let firstItem = (currentPage * itemsPerPage - itemsPerPage)
        //- - let firstItem = 1

        - let lastItem = (firstItem + itemsPerPage)
        //- - let lastItem = 3

        if search === true
          if book.id >= firstItem && book.id <= lastItem && book.id <= items
            td 
              a(href="/books/"+(book.id)) #{book.title}
            td #{book.author}
            td #{book.genre}
            td #{book.year}
        else
          td 
            a(href="/books/"+(book.id)) #{book.title}
          td #{book.author}
          td #{book.genre}
          td #{book.year}
        


    //- Show pagination buttons

  - let i = 1;
  while i <= pages
    a.button(href="/page/"+i) #{i}
    - i++
    //- Show pug template name
  h5 index.pug